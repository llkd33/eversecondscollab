# 구현 작업 목록

- [x] 1. 데이터베이스 스키마 설계 및 구축 ✅ **완료**
  - Supabase 프로젝트 생성 및 기본 설정
  - 새로운 DB 스키마에 따른 테이블 생성 (users, shops, products, transactions, chats, messages, reviews, safe_transactions)
  - 테이블 간 관계 설정 및 인덱스 생성
  - RLS(Row Level Security) 정책 설정
  - _요구사항: 1.4, 1.5_

- [x] 2. Flutter 데이터 모델 및 서비스 구현
  - [x] 2.1 핵심 데이터 모델 클래스 작성
    - User, Shop, Product, Transaction, Chat, Message, Review, SafeTransaction 모델 클래스
    - JSON 직렬화/역직렬화 메서드 구현
    - 데이터 검증 로직 추가
    - _요구사항: 1.4, 2.1, 3.1_

  - [x] 2.2 Supabase 연동 서비스 구현
    - Supabase 클라이언트 설정 및 초기화
    - 각 모델별 CRUD 서비스 클래스 작성
    - 실시간 구독 기능 구현
    - _요구사항: 5.1, 10.5_

- [x] 3. 사용자 인증 시스템 구현
  - [x] 3.1 카카오 로그인 기능
    - 카카오 SDK 연동 및 설정
    - 카카오 로그인 플로우 구현 (이름, 전화번호, 프로필 정보 자동 가져오기)
    - Supabase Auth와 연동하여 사용자 정보 저장
    - email을 사용자 ID로 활용하되 카카오 로그인 시 변경 처리
    - _요구사항: 1.1_

  - [x] 3.2 SMS 인증 기능
    - SMS 인증 서비스 연동
    - 핸드폰 번호 입력 및 인증번호 발송 로직
    - 인증번호 검증 및 본인 확인 처리
    - 전화번호 중복 가입 방지 로직
    - _요구사항: 1.2, 1.3_

- [x] 4. 상품 관리 시스템 구현
  - [x] 4.1 상품 등록 기능
    - 상품 정보 입력 폼 구현 (title, price, description, images, category)
    - 이미지 업로드 및 Supabase Storage 연동
    - 대신팔기 옵션 설정 (resale_enabled, resale_fee 퍼센티지 입력)
    - 상품 등록 시 status를 '판매중'으로 설정
    - _요구사항: 2.1, 2.2_

  - [x] 4.2 상품 조회 및 관리 기능
    - 상품 리스트 조회 API 구현 (최신순 정렬 기본)
    - 카테고리별 필터링 및 검색 기능
    - 상품 상세 조회 기능
    - 판매자의 거래완료 버튼 기능 (status를 '판매완료'로 변경)
    - _요구사항: 2.3, 2.4, 2.5_

- [ ] 5. 개인 샵 및 대신팔기 시스템 구현
  - [ ] 5.1 개인 샵 생성 및 관리
    - 사용자 회원가입 시 자동 Shop 생성
    - 샵 정보 관리 (name, description)
    - 공유 가능한 URL 생성 및 관리
    - 등록 상품과 대신팔기 상품 구분 표시
    - _요구사항: 3.1, 8.3, 8.4_

  - [ ] 5.2 대신팔기 기능 구현
    - 대신팔기 상품을 Shop의 resale_products에 추가하는 로직
    - 수수료 퍼센티지 입력 시 자동 금액 계산 기능
    - 대신판매자 마이페이지에서 수수료 정보 확인 기능
    - 대신팔기 수수료 제한 없음 정책 적용
    - _요구사항: 3.1, 3.2, 3.5_

- [ ] 6. 실시간 채팅 시스템 구현
  - [ ] 6.1 채팅방 생성 및 기본 기능
    - 구매 관심 표시 시 Chat 생성 (participants, transaction 연결)
    - Supabase Realtime을 활용한 실시간 메시징
    - Message 전송/수신 기능 (sender, content 저장)
    - 채팅 히스토리 조회 기능
    - _요구사항: 5.1, 5.5_

  - [ ] 6.2 안전거래 연동 기능
    - 채팅방 상단에 안전거래/일반거래 버튼 UI 구현
    - "안전한 거래를 하기 원하시면 안전거래로 거래하세요" 안내 표시
    - 법인계좌 입금 안내 및 입금확인 요청 버튼 구현
    - 대신판매 거래 시 "ㅇㅇㅇ님에 의해 대신판매되는 거래" 표시
    - _요구사항: 5.2, 5.3, 3.4_

- [ ] 7. 안전거래 시스템 구현
  - [ ] 7.1 안전거래 프로세스 구현
    - 입금확인 요청 시 관리자에게 SMS 발송 기능
    - Safe_Transaction 테이블 생성 및 관리
    - 어드민 입금 확인 시 판매자/대신판매자에게 SMS 발송
    - 배송완료 버튼 클릭 시 구매자에게 배송정보 SMS 발송
    - _요구사항: 6.1, 6.2, 9.2, 9.3_

  - [ ] 7.2 정산 처리 시스템
    - 구매자 완료 버튼 클릭 시 회사에 거래 정상 처리 SMS 발송
    - 어드민에서 정산 준비 → 정산 처리 → 정산 완료 단계 관리
    - 일반거래 시 판매자 직접 거래완료 처리 로직
    - 정산 완료 후 어드민 버튼 클릭 기능
    - _요구사항: 6.3, 6.5, 9.4, 9.5_

- [ ] 8. 거래 및 리뷰 시스템 구현
  - [ ] 8.1 거래 관리 기능
    - Transaction 생성 및 관리 (product, price, resale_fee, buyer, seller, reseller, status, chat)
    - 거래 상태 관리 (거래중, 거래중단, 거래완료)
    - 상품 등록자가 거래완료를 눌러야 하는 정책 구현
    - _요구사항: 8.5, 7.3_

  - [ ] 8.2 리뷰 시스템 구현
    - 거래 완료 후 리뷰 작성 기능 (강제 아님)
    - 판매자↔구매자, 대신판매자↔상품등록자 상호 리뷰 가능
    - Review 모델 구현 (reviewer, transaction, comment)
    - 사용자 프로필에서 받은 리뷰 목록 표시
    - _요구사항: 7.1, 7.2, 7.4, 7.5_

- [ ] 9. 마이페이지 및 거래 관리 구현
  - [ ] 9.1 마이페이지 기본 기능
    - 내 프로필 정보 표시 및 수정 기능
    - 내 샵 보기 기능 (등록 상품/대신팔기 상품 구분)
    - 내 상품 관리 기능
    - _요구사항: 8.1, 8.2, 8.3_

  - [ ] 9.2 거래 내역 관리
    - 구매내역/판매내역/대신팔기 내역 구분 표시
    - 거래 상태별 필터링 기능
    - 거래 상세 정보 조회
    - _요구사항: 8.2_

- [x] 10. 웹 인터페이스 구현 (키오스크 전용) ✅ **부분 완료**
  - [x] 10.1 키오스크 홈 페이지 ✅ **기본 구조 완료**
    - 상품 카드 목록 표시 (썸네일/가격/판매자명)
    - 카테고리/검색 필터 기능
    - 로그인/거래 버튼 없는 조회 전용 UI
    - 키오스크 사이즈 반응형 디자인
    - _요구사항: 10.2, 10.5_

  - [ ] 10.2 상품 상세 페이지 및 QR 연결
    - 판매자 정보, 이미지 슬라이드, 설명, 가격 표시
    - 구매하기/대신팔기 버튼 클릭 시 QR 팝업 표시
    - 앱 설치 안내 기능
    - _요구사항: 10.3, 10.4_

- [x] 11. 관리자 시스템 구현 (웹 전용) ✅ **부분 완료**
  - [x] 11.1 관리자 대시보드 ✅ **기본 구조 완료**
    - 관리자 로그인 기능
    - 유저 관리, 상품 관리, 거래 현황 대시보드
    - 사용자/거래 통계 표시
    - _요구사항: 9.1_

  - [ ] 11.2 안전거래 관리 시스템
    - 입금확인 요청 알림 수신 및 처리
    - 안전거래 관리 DB 조회 및 상태 업데이트
    - 입금 확인 버튼 및 SMS 발송 기능
    - 정산 처리 단계별 관리 (정산준비 → 정산처리 → 정산완료)
    - _요구사항: 9.2, 9.3, 9.4, 9.5_

- [ ] 12. SMS 알림 시스템 구현
  - [ ] 12.1 SMS 서비스 연동
    - SMS 발송 서비스 API 연동
    - 각종 알림 메시지 템플릿 작성
    - SMS 발송 로그 관리
    - _요구사항: 1.2, 6.1, 6.2_

  - [ ] 12.2 알림 시나리오 구현
    - 입금확인 요청 시 관리자 알림
    - 입금 확인 시 판매자/대신판매자 알림
    - 배송완료 시 구매자 알림
    - 거래완료 시 회사 알림
    - _요구사항: 5.4, 6.1, 6.2, 6.3_

## 🚀 **우선순위 높은 미완료 태스크**

- [ ] **A1. Supabase 실제 데이터 연동** ⭐ **최우선**
  - Flutter 앱의 Mock 데이터를 실제 Supabase 연동으로 변경
  - 상품 조회, 등록, 수정, 삭제 API 연동
  - 실시간 데이터 업데이트 구현
  - _현재: Mock 데이터 사용 중_

- [ ] **A2. 사용자 인증 시스템 완성** ⭐ **최우선**
  - 카카오 로그인 SDK 연동 및 Supabase Auth 연결
  - SMS 인증 시스템 구현
  - 사용자 세션 관리 및 자동 로그인
  - _현재: 로그인 화면만 UI 구현됨_

- [ ] **A3. 실시간 채팅 시스템 구현** ⭐ **핵심 기능**
  - Supabase Realtime을 활용한 실시간 메시징
  - 채팅방 생성 및 메시지 전송/수신
  - 안전거래/일반거래 선택 UI 연동
  - _현재: 채팅 화면 UI만 구현됨_

## 📋 **기존 태스크 (우선순위 조정)**

- [ ] 13. 테스트 및 최적화
  - [ ] 13.1 기능 테스트
    - 각 기능별 단위 테스트 작성
    - 안전거래 전체 플로우 E2E 테스트
    - 대신팔기 기능 통합 테스트
    - 실시간 채팅 기능 테스트

  - [ ] 13.2 성능 최적화 및 배포 준비
    - 데이터베이스 쿼리 최적화
    - 이미지 업로드 및 표시 최적화
    - Flutter 앱 빌드 및 배포 설정
    - Next.js 웹 배포 설정